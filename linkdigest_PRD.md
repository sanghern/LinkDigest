# LinkDigest 북마크 요약 서비스 요구사항 명세서 (PRD)

## 문서 정보

- **문서명**: LinkDigest 서비스 요구사항 명세서
- **버전**: 1.2
- **작성일**: 2026-02-14
- **최종 업데이트**: 2026-02-14
- **작성자**: LinkDigest 개발팀
- **참고 문서**: [설계서](./linkdigest_설계서.md), [설계서 vs PRD 검토](./linkdigest_설계서_PRD검토.md), [Backend 문서](./backend/backend.md), [Frontend 문서](./frontend/frontend.md)

---

## 1. 프로젝트 개요

### 1.1 프로젝트 목적
LinkDigest는 웹 URL을 입력받아 자동으로 콘텐츠를 스크래핑하고, AI를 활용하여 요약 및 키워드 추출을 수행하는 북마크 관리 서비스입니다. 
사용자가 웹 콘텐츠를 효율적으로 관리하고 검색할 수 있도록 지원합니다.

### 1.2 프로젝트 범위
- 웹 URL 기반 콘텐츠 자동 수집 및 저장
- AI 기반 콘텐츠 요약 및 키워드 추출
- 사용자별 북마크 관리 및 검색
- 웹 기반 사용자 인터페이스 제공
- 로그 관리 및 모니터링 기능

### 1.3 주요 이해관계자
- **최종 사용자**: 북마크를 관리하고 검색하는 일반 사용자
- **시스템 관리자**: 시스템 운영 및 모니터링 담당자
- **개발팀**: 시스템 개발 및 유지보수 담당자

---

## 2. 목표 및 성공 기준

### 2.1 비즈니스 목표
- 웹 콘텐츠를 효율적으로 수집하고 관리할 수 있는 플랫폼 제공
- AI를 활용한 자동 요약으로 콘텐츠 이해도 향상
- 키워드 기반 검색으로 원하는 정보 빠르게 찾기

### 2.2 성공 기준
- 북마크 생성 후 30초 이내 요약 생성 완료
- 검색 응답 시간 1초 이내
- 시스템 가용성 99% 이상
- 사용자 만족도 4.0/5.0 이상

---

## 3. 사용자 스토리

### 3.1 사용자 인증 관련
- **US-001**: 사용자는 사용자명과 비밀번호로 로그인할 수 있어야 한다.
- **US-002**: 사용자는 로그아웃할 수 있어야 한다.
- **US-003**: 사용자는 현재 로그인 상태를 확인할 수 있어야 한다.
- **US-004**: 사용자의 인증 토큰은 30분 후 자동 만료되어야 한다.

### 3.2 북마크 관리 관련
- **US-005**: 사용자는 URL을 입력하여 북마크를 생성할 수 있어야 한다.
- **US-006**: 시스템은 URL에서 자동으로 제목과 콘텐츠를 추출해야 한다.
- **US-007**: 시스템은 영어 제목을 한글로 자동 번역해야 한다.
- **US-008**: 시스템은 콘텐츠를 AI로 요약하여 생성해야 한다.
- **US-009**: 시스템은 요약에서 키워드를 자동 추출하여 태그로 저장해야 한다.
- **US-010**: 사용자는 북마크 목록을 페이지네이션으로 조회할 수 있어야 한다.
- **US-011**: 사용자는 북마크를 수정할 수 있어야 한다.
- **US-012**: 사용자는 북마크를 삭제할 수 있어야 한다.
- **US-013**: 사용자는 북마크 상세 정보를 조회할 수 있어야 한다.
- **US-014**: 시스템은 북마크 조회 시 조회수를 자동 증가시켜야 한다.

### 3.3 검색 기능 관련
- **US-015**: 사용자는 키워드를 클릭하여 해당 키워드로 필터링할 수 있어야 한다.
- **US-016**: 사용자는 여러 키워드를 동시에 선택하여 AND 조건으로 검색할 수 있어야 한다.
- **US-017**: 사용자는 하나의 키워드 내에서 구분자(공백, ',', '-', '·')로 구분된 단어를 OR 조건으로 검색할 수 있어야 한다.
- **US-018**: 시스템은 부분 일치 검색을 지원해야 한다.
- **US-019**: 사용자는 선택한 필터를 개별적으로 제거할 수 있어야 한다.
- **US-020**: 사용자는 모든 필터를 한 번에 제거할 수 있어야 한다.
- **US-021**: 시스템은 필터링된 결과의 총 개수를 표시해야 한다.

### 3.4 로그 관리 관련
- **US-022**: 시스템은 프론트엔드와 백엔드 로그를 저장해야 한다.
- **US-023**: 사용자는 로그를 레벨, 소스, 검색어로 필터링할 수 있어야 한다.
- **US-024**: 사용자는 로그 통계를 조회할 수 있어야 한다.

---

## 4. 기능 요구사항 (Functional Requirements)

### 4.1 사용자 인증 및 권한 관리

#### FR-001: 사용자 로그인
- **우선순위**: 필수 (Must Have)
- **설명**: 사용자는 사용자명과 비밀번호로 로그인할 수 있어야 한다.
- **입력**: 사용자명(String), 비밀번호(String)
- **처리**:
  - 사용자명으로 사용자 조회
  - 비밀번호 해시 검증 (bcrypt)
  - JWT 토큰 생성
  - 세션 정보 DB 저장
- **출력**: JWT 토큰, 사용자 정보
- **에러 처리**: 잘못된 자격 증명 시 401 에러 반환

#### FR-002: 사용자 로그아웃
- **우선순위**: 필수 (Must Have)
- **설명**: 사용자는 로그아웃할 수 있어야 한다.
- **입력**: JWT 토큰
- **처리**: 세션 정보 DB에서 삭제 또는 비활성화
- **출력**: 성공 메시지

#### FR-003: 현재 사용자 정보 조회
- **우선순위**: 필수 (Must Have)
- **설명**: 사용자는 현재 로그인한 사용자 정보를 조회할 수 있어야 한다.
- **입력**: JWT 토큰
- **처리**: 토큰 검증 후 사용자 정보 반환
- **출력**: 사용자 ID, 사용자명, 이메일

#### FR-004: 인증 토큰 자동 만료
- **우선순위**: 필수 (Must Have)
- **설명**: JWT 토큰은 발급 후 30분 후 자동 만료되어야 한다.
- **처리**: 토큰 생성 시 만료 시간 설정, 만료된 토큰으로 요청 시 401 에러 반환

### 4.2 북마크 관리

#### FR-005: 북마크 생성
- **우선순위**: 필수 (Must Have)
- **설명**: 사용자는 URL을 입력하여 북마크를 생성할 수 있어야 한다.
- **입력**: URL(String, 필수), 제목(String, 선택), 태그(Array[String], 선택)
- **처리**:
  1. URL 중복 체크 (동일 사용자, 동일 URL)
  2. 웹 스크래핑 수행 (제목, 콘텐츠 추출)
  3. 제목이 없으면 스크래핑한 제목 사용
  4. 영어 제목 감지 및 번역 (Ollama API)
  5. 북마크 DB 저장
  6. 비동기 요약 태스크 시작 (ThreadPoolExecutor)
- **출력**: 생성된 북마크 정보 (ID, 제목, URL 등)
- **에러 처리**: 
  - 잘못된 URL 형식: 400 에러
  - 스크래핑 실패: 500 에러
  - 중복 URL: 409 에러

#### FR-006: 웹 스크래핑
- **우선순위**: 필수 (Must Have)
- **설명**: 시스템은 URL에서 자동으로 제목과 콘텐츠를 추출해야 한다.
- **제목 추출 우선순위**:
  1. og:title 메타 태그
  2. article 태그 내 h1 태그
  3. 일반 h1 태그
  4. title 태그
- **콘텐츠 추출**:
  - 메인 콘텐츠 영역 자동 감지
  - 불필요한 요소 제거 (script, style, nav, footer 등)
  - 참조 링크 추출
  - 이미지 추출
- **출력**: 제목(String), 콘텐츠(Text), 소스명(String)

#### FR-007: 제목 자동 번역
- **우선순위**: 필수 (Must Have)
- **설명**: 시스템은 영어 제목을 한글로 자동 번역해야 한다.
- **처리**:
  - 영어 제목 자동 감지
  - Ollama translategemma:4b 모델 사용
  - 번역 후 `한글(영문)` 형태로 저장
  - 이미 한글인 경우 번역 생략
- **출력**: 번역된 제목 (String)

#### FR-008: AI 기반 요약 생성
- **우선순위**: 필수 (Must Have)
- **설명**: 시스템은 콘텐츠를 AI로 요약하여 생성해야 한다.
- **처리**:
  - 비동기 백그라운드 처리 (ThreadPoolExecutor, 최대 3개 워커)
  - Ollama gpt-oss:120b-cloud 모델 사용
  - 마크다운 형식으로 요약 생성
  - 핵심 요약 5줄 생성
  - 요약 생성 중에는 "요약 생성 중..." 메시지 표시
- **출력**: 요약 내용 (Text, 마크다운 형식)

#### FR-009: 키워드 자동 추출
- **우선순위**: 필수 (Must Have)
- **설명**: 시스템은 요약에서 키워드를 자동 추출하여 태그로 저장해야 한다.
- **처리**:
  - 요약 생성 시 키워드 추출
  - 쉼표(,)로 구분된 키워드 문자열 파싱
  - 빈 문자열 제거 및 공백 제거
  - PostgreSQL ARRAY 타입으로 저장
- **출력**: 태그 배열 (Array[String])

#### FR-010: 북마크 목록 조회
- **우선순위**: 필수 (Must Have)
- **설명**: 사용자는 북마크 목록을 페이지네이션으로 조회할 수 있어야 한다.
- **입력**: 
  - page (Integer, 기본값: 1)
  - per_page (Integer, 기본값: 10)
  - tags (Array[String], 선택)
- **처리**:
  - 사용자별 북마크 조회
  - 태그 필터링 적용 (있는 경우)
  - 최신순 정렬 (created_at DESC)
  - 페이지네이션 적용
- **출력**: 
  - items: 북마크 배열
  - total: 전체 개수
  - page: 현재 페이지
  - per_page: 페이지당 항목 수
  - total_pages: 전체 페이지 수

#### FR-011: 북마크 수정
- **우선순위**: 필수 (Must Have)
- **설명**: 사용자는 북마크를 수정할 수 있어야 한다.
- **입력**: 북마크 ID, 수정할 필드 (제목, URL, 태그, 요약 등)
- **처리**:
  - 북마크 소유자 확인
  - 수정 권한 검증
  - DB 업데이트
- **출력**: 수정된 북마크 정보
- **에러 처리**: 권한 없음 시 403 에러

#### FR-012: 북마크 삭제
- **우선순위**: 필수 (Must Have)
- **설명**: 사용자는 북마크를 삭제할 수 있어야 한다.
- **입력**: 북마크 ID
- **처리**:
  - 북마크 소유자 확인
  - 삭제 권한 검증
  - DB에서 삭제 (또는 is_deleted 플래그 설정)
- **출력**: 성공 메시지
- **에러 처리**: 권한 없음 시 403 에러

#### FR-013: 북마크 상세 조회
- **우선순위**: 필수 (Must Have)
- **설명**: 사용자는 북마크 상세 정보를 조회할 수 있어야 한다.
- **입력**: 북마크 ID
- **처리**:
  - 북마크 조회
  - 조회수 증가 (FR-014)
- **출력**: 북마크 상세 정보 (제목, URL, 요약, 콘텐츠, 태그, 조회수 등)

#### FR-014: 조회수 자동 증가
- **우선순위**: 필수 (Must Have)
- **설명**: 시스템은 북마크 조회 시 조회수를 자동 증가시켜야 한다.
- **처리**:
  - 북마크 상세 조회(GET /api/bookmarks/{id}) 시 트리거
  - **중복 증가 방지**: 동일 세션 또는 동일 인증 사용자에 대해 일정 시간 내 중복 조회는 1회만 증가 (세션/사용자 기준 정책)
  - DB 업데이트
- **출력**: 증가된 조회수

### 4.3 검색 기능

#### FR-015: 키워드 클릭 필터링
- **우선순위**: 필수 (Must Have)
- **설명**: 사용자는 키워드를 클릭하여 해당 키워드로 필터링할 수 있어야 한다.
- **입력**: 키워드 (String)
- **처리**:
  - 선택된 키워드 배열에 추가/제거 (토글 방식)
  - 이미 선택된 키워드면 제거, 없으면 추가
  - 첫 페이지로 이동
  - 필터링된 결과 조회
- **출력**: 필터링된 북마크 목록
- **UI 요구사항**: 선택된 키워드는 파란색 배경으로 표시

#### FR-016: 다중 키워드 AND 조건 검색
- **우선순위**: 필수 (Must Have)
- **설명**: 사용자는 여러 키워드를 동시에 선택하여 AND 조건으로 검색할 수 있어야 한다.
- **입력**: 키워드 배열 (Array[String])
- **처리**:
  - 각 키워드에 대해 부분 일치 검색 수행
  - 여러 키워드를 AND 조건으로 결합
  - PostgreSQL EXISTS 서브쿼리 사용
- **출력**: 모든 키워드 조건을 만족하는 북마크 목록
- **예시**: tags=["AI", "코딩"] → ("AI" 포함) AND ("코딩" 포함)

#### FR-017: 키워드 구분자 지원 (OR 조건)
- **우선순위**: 필수 (Must Have)
- **설명**: 사용자는 하나의 키워드 내에서 구분자(공백, ',', '-', '·')로 구분된 단어를 OR 조건으로 검색할 수 있어야 한다.
- **입력**: 구분자로 구분된 키워드 (예: "AI 코딩", "AI,코딩", "AI-코딩", "AI·코딩")
- **처리**:
  - 키워드를 구분자로 분리 (정규식: `[\s,\-·]+`)
  - 분리된 각 단어에 대해 부분 일치 검색 수행
  - 분리된 단어들을 OR 조건으로 결합
- **출력**: 분리된 단어 중 하나라도 포함하는 북마크 목록
- **예시**: tags=["AI 코딩"] → ("AI" 포함) OR ("코딩" 포함)

#### FR-018: 부분 일치 검색
- **우선순위**: 필수 (Must Have)
- **설명**: 시스템은 부분 일치 검색을 지원해야 한다.
- **처리**:
  - PostgreSQL LIKE 검색 사용
  - 패턴: `%keyword%` (앞뒤 와일드카드)
  - 대소문자 구분 없음 (PostgreSQL 기본 동작)
- **예시**: "AI" 검색 시 "AI", "AI coding", "chatbot AI" 모두 검색됨

#### FR-019: 필터 개별 제거
- **우선순위**: 필수 (Must Have)
- **설명**: 사용자는 선택한 필터를 개별적으로 제거할 수 있어야 한다.
- **입력**: 제거할 키워드 (String)
- **처리**:
  - 선택된 키워드 배열에서 해당 키워드 제거
  - 첫 페이지로 이동
  - 필터링된 결과 조회
- **UI 요구사항**: 각 필터 키워드에 X 버튼 제공

#### FR-020: 필터 전체 제거
- **우선순위**: 필수 (Must Have)
- **설명**: 사용자는 모든 필터를 한 번에 제거할 수 있어야 한다.
- **처리**:
  - 선택된 키워드 배열 초기화
  - 첫 페이지로 이동
  - 전체 북마크 목록 조회
- **UI 요구사항**: "전체 제거" 버튼 제공

#### FR-021: 필터링 결과 총 개수 표시
- **우선순위**: 필수 (Must Have)
- **설명**: 시스템은 필터링된 결과의 총 개수를 표시해야 한다.
- **처리**:
  - 필터링 쿼리 실행 시 총 개수 조회
  - 북마크 목록 제목에 표시
- **출력 형식**: "북마크 목록(100개)"
- **UI 요구사항**: 제목 옆에 괄호로 총 개수 표시

### 4.4 로그 관리

#### FR-022: 로그 저장
- **우선순위**: 필수 (Must Have)
- **설명**: 시스템은 프론트엔드와 백엔드 로그를 저장해야 한다.
- **입력**: 로그 레벨, 메시지, 소스, 메타데이터 등
- **처리**:
  - 로그 레벨: INFO, WARN, ERROR (파일 로깅 시 DEBUG 포함)
  - 소스: frontend, backend
  - 타임스탬프 자동 추가
  - DB에 저장 (파일: backend/logs/app.log)
- **저장 위치**: PostgreSQL logs 테이블
- **보관**: 최소 30일 보관. 만료된 세션은 정기적으로 정리.

#### FR-023: 로그 필터링
- **우선순위**: 필수 (Must Have)
- **설명**: 사용자는 로그를 레벨, 소스, 검색어로 필터링할 수 있어야 한다.
- **입력**: 레벨(INFO/WARN/ERROR), 소스(frontend/backend), 검색어(String)
- **처리**:
  - 필터 조건에 맞는 로그 조회
  - 페이지네이션 적용
- **출력**: 필터링된 로그 목록

#### FR-024: 로그 통계 조회
- **우선순위**: 필수 (Must Have)
- **설명**: 사용자는 로그 통계를 조회할 수 있어야 한다.
- **처리**:
  - 전체 로그 개수
  - 에러 로그 개수
  - 최근 24시간 로그 개수
- **출력**: 통계 정보 (total, errors, last_24h)

---

## 5. 비기능 요구사항 (Non-Functional Requirements)

### 5.1 성능 요구사항

#### NFR-001: 응답 시간
- **우선순위**: 필수 (Must Have)
- **요구사항**:
  - API 응답 시간: 1초 이내 (95 percentile)
  - 검색 응답 시간: 1초 이내
  - 페이지 로딩 시간: 3초 이내
- **측정 방법**: 응답 시간 모니터링 및 로그 분석

#### NFR-002: 처리량
- **우선순위**: 필수 (Must Have)
- **요구사항**:
  - 동시 사용자: 최소 100명 지원
  - 초당 요청 처리: 최소 50 TPS
- **측정 방법**: 부하 테스트

#### NFR-003: 비동기 처리
- **우선순위**: 필수 (Must Have)
- **요구사항**:
  - 요약 생성은 백그라운드에서 비동기 처리
  - 요약 생성 완료 시간: 30초 이내
  - ThreadPoolExecutor 최대 3개 워커 사용
- **측정 방법**: 태스크 완료 시간 모니터링

### 5.2 가용성 요구사항

#### NFR-004: 시스템 가용성
- **우선순위**: 필수 (Must Have)
- **요구사항**: 시스템 가용성 99% 이상
- **측정 방법**: 업타임 모니터링

#### NFR-005: 에러 처리
- **우선순위**: 필수 (Must Have)
- **요구사항**:
  - 모든 API 에러는 적절한 HTTP 상태 코드 반환 (400, 401, 403, 409, 500 등, IR-004 참조)
  - 에러 메시지는 사용자 친화적으로 표시
  - 에러는 로그에 기록 (민감 정보 제외)
- **측정 방법**: 에러 로그 분석

### 5.3 보안 요구사항

#### NFR-006: 인증 및 권한
- **우선순위**: 필수 (Must Have)
- **요구사항**:
  - JWT 기반 인증 사용
  - 비밀번호는 bcrypt로 해시화하여 저장
  - 토큰 만료 시간: 30분
  - 인증되지 않은 사용자는 보호된 리소스 접근 불가
- **측정 방법**: 보안 테스트

#### NFR-007: 데이터 보안
- **우선순위**: 필수 (Must Have)
- **요구사항**:
  - SQL Injection 방지: ORM 사용
  - XSS 방지: React 자동 이스케이핑
  - CSRF 방지: SameSite 쿠키 설정
  - **민감 정보 로그 미기록**: 비밀번호, JWT 토큰은 로그에 기록하지 않음. 환경 변수로 민감 정보 관리.
- **측정 방법**: 보안 취약점 스캔

#### NFR-008: CORS 설정
- **우선순위**: 필수 (Must Have)
- **요구사항**:
  - 허용된 오리진만 접근 가능
  - CORS 설정은 환경 변수로 관리
- **측정 방법**: CORS 테스트

### 5.4 확장성 요구사항

#### NFR-009: 데이터베이스 확장성
- **우선순위**: 권장 (Should Have)
- **요구사항**:
  - 데이터베이스 연결 풀 사용
  - 인덱싱 최적화 (username, email, user_id)
  - 쿼리 최적화 (EXISTS 서브쿼리)
- **측정 방법**: 쿼리 성능 분석

#### NFR-010: 프론트엔드 확장성
- **우선순위**: 권장 (Should Have)
- **요구사항**:
  - 컴포넌트 메모이제이션 (useCallback, useMemo)
  - 코드 스플리팅 (React Router lazy loading)
  - 페이지네이션으로 대량 데이터 처리
- **측정 방법**: 성능 프로파일링

### 5.5 사용성 요구사항

#### NFR-011: 사용자 인터페이스
- **우선순위**: 필수 (Must Have)
- **요구사항**:
  - **반응형 웹 디자인**: 모바일 320px 이상, 태블릿 768px 이상, 데스크톱 1024px 이상에서 정상 동작 (IR-002와 일치)
  - 마크다운 코드 블록 다크 테마 적용으로 가독성 향상
  - 모바일 터치 스크롤 최적화
  - 직관적인 UI/UX
  - 로딩 상태 표시
  - 에러 메시지 명확하게 표시
- **측정 방법**: 사용성 테스트

#### NFR-012: 접근성
- **우선순위**: 권장 (Should Have)
- **요구사항**:
  - 키보드 네비게이션 지원
  - 스크린 리더 호환성
  - 색상 대비 충족
- **측정 방법**: 접근성 테스트

---

## 6. 시스템 요구사항

### 6.1 하드웨어 요구사항

#### SR-001: 서버 하드웨어
- **Backend 서버**:
  - CPU: 최소 2코어, 권장 4코어 이상
  - 메모리: 최소 4GB, 권장 8GB 이상
  - 디스크: 최소 20GB 여유 공간
- **Frontend 서버**:
  - CPU: 최소 1코어, 권장 2코어 이상
  - 메모리: 최소 2GB, 권장 4GB 이상
  - 디스크: 최소 10GB 여유 공간
- **데이터베이스 서버**:
  - CPU: 최소 2코어, 권장 4코어 이상
  - 메모리: 최소 4GB, 권장 8GB 이상
  - 디스크: 최소 50GB 여유 공간 (데이터 증가 고려)

### 6.2 소프트웨어 요구사항

#### SR-002: 운영 체제
- **Backend**: Linux (Ubuntu 20.04 이상 권장), macOS, Windows
- **Frontend**: Linux, macOS, Windows
- **데이터베이스**: Linux (PostgreSQL 권장 환경)

#### SR-003: 런타임 및 프레임워크
- **Backend**:
  - Python 3.11 이상
  - FastAPI 0.109.2
  - Uvicorn 0.27.1
- **Frontend**:
  - Node.js 16 이상
  - React 18.2.0
  - npm 또는 yarn

#### SR-004: 데이터베이스
- **PostgreSQL**: 최신 안정 버전
- **연결**: TCP/IP 연결 지원
- **인코딩**: UTF-8

#### SR-005: 외부 서비스
- **Ollama 서버**: 로컬 또는 원격 LLM 서버
  - 요약 모델: gpt-oss:120b-cloud
  - 번역 모델: translategemma:4b
- **웹 서버**: Nginx (프록시 서버)

---

## 7. 인터페이스 요구사항

### 7.1 사용자 인터페이스

#### IR-001: 웹 브라우저 호환성
- **지원 브라우저**:
  - Chrome (최신 2개 버전)
  - Firefox (최신 2개 버전)
  - Safari (최신 2개 버전)
  - Edge (최신 2개 버전)
- **요구사항**: JavaScript 활성화 필수

#### IR-002: 반응형 디자인
- **모바일**: 화면 너비 320px 이상
- **태블릿**: 화면 너비 768px 이상
- **데스크톱**: 화면 너비 1024px 이상
- **요구사항**: 모든 화면 크기에서 정상 동작

### 7.2 API 인터페이스

#### IR-003: RESTful API
- **프로토콜**: HTTP/HTTPS
- **데이터 형식**: JSON
- **인증 방식**: JWT Bearer Token
- **API 베이스 경로**: 현재 `/api`. 향후 버전 관리 시 `/api/v1` 전환 가능.

#### IR-004: API 공통 에러 응답
- **요구사항**: 모든 API는 다음 HTTP 상태 코드를 적절한 상황에 반환해야 한다. 에러 응답 본문은 사용자 친화적 메시지를 포함하며, 에러는 로그에 기록한다.
- **400 Bad Request**: 잘못된 요청 (예: URL 형식 오류, 유효성 검증 실패)
- **401 Unauthorized**: 인증 실패, 토큰 없음, 토큰 만료
- **403 Forbidden**: 권한 없음 (예: 타 사용자 리소스 수정/삭제 시도)
- **409 Conflict**: 리소스 충돌 (예: 동일 사용자·동일 URL 북마크 중복)
- **500 Internal Server Error**: 서버 내부 오류 (예: 스크래핑 실패, DB 오류)

#### IR-005: API 엔드포인트
- **인증**: `/api/auth/login`, `/api/auth/logout`, `/api/auth/me`
- **북마크**: `/api/bookmarks/` (CRUD)
- **로그**: `/api/logs/`, `/api/logs/stats`

### 7.3 외부 API 인터페이스

#### IR-006: Ollama API
- **프로토콜**: HTTP
- **엔드포인트**: `/api/chat` (기본값: `http://localhost:11434/api/chat`)
- **인증**: 필요 없음 (로컬 서버)
- **요청 형식**: JSON
- **응답 형식**: JSON

---

## 8. 데이터 요구사항

### 8.1 데이터 모델

#### DR-001: 사용자 데이터
- **필수 필드**: id, username, email, hashed_password, created_at, is_active
- **선택 필드**: last_login
- **제약사항**:
  - username: 최대 50자, 고유값, 인덱스
  - email: 최대 100자, 고유값, 인덱스
  - password: 해시화하여 저장 (원문 저장 안 함)

#### DR-002: 북마크 데이터
- **필수 필드**: id, user_id, title, url, created_at, updated_at, read_count, is_deleted
- **선택 필드**: summary, content, source_name, tags, category
- **제약사항**:
  - title: 최대 255자
  - url: Text 타입 (길이 제한 없음)
  - tags: PostgreSQL ARRAY(String) 타입
  - user_id: users 테이블 외래키, CASCADE 삭제

#### DR-003: 로그 데이터
- **필수 필드**: id, level, message, source, timestamp
- **선택 필드**: user_id, request_path, request_method, response_status, execution_time, meta_data
- **제약사항**:
  - level: INFO, WARN, ERROR 중 하나
  - source: frontend, backend 중 하나
  - meta_data: JSONB 타입

#### DR-004: 세션 데이터
- **필수 필드**: id, user_id, token, expires_at
- **제약사항**:
  - user_id: users 테이블 외래키
  - token: 고유값
  - expires_at: 만료 시간

### 8.2 데이터 무결성

#### DR-005: 참조 무결성
- **요구사항**: 외래키 제약조건으로 참조 무결성 보장
- **CASCADE 삭제**: 사용자 삭제 시 관련 북마크, 세션 자동 삭제

#### DR-006: 데이터 검증
- **요구사항**: 
  - Pydantic 스키마로 입력 데이터 검증
  - 데이터베이스 레벨 제약조건 (NOT NULL, UNIQUE 등)

### 8.3 데이터 보관

#### DR-007: 데이터 보관 기간
- **북마크**: 삭제되지 않는 한 무기한 보관
- **로그**: 최소 30일 보관 (필요시 더 오래 보관 가능)
- **세션**: 만료된 세션은 정기적으로 정리

---

## 9. 보안 요구사항

### 9.1 인증 및 권한

#### SEC-001: 사용자 인증
- **요구사항**:
  - JWT 기반 인증 사용
  - OAuth2 Password Flow
  - 토큰 만료 시간: 30분
  - 토큰은 HTTP 헤더에 Bearer 형식으로 전달

#### SEC-002: 비밀번호 보안
- **요구사항**:
  - 비밀번호는 bcrypt로 해시화하여 저장
  - 원문 비밀번호는 절대 저장하지 않음
  - 비밀번호 복잡도 요구사항 (선택사항)

#### SEC-003: 권한 관리
- **요구사항**:
  - 사용자는 자신의 북마크만 접근 가능
  - 다른 사용자의 북마크 접근 시 403 에러 반환

### 9.2 데이터 보안

#### SEC-004: SQL Injection 방지
- **요구사항**: SQLAlchemy ORM 사용으로 SQL Injection 방지

#### SEC-005: XSS 방지
- **요구사항**: React의 자동 이스케이핑 활용

#### SEC-006: CSRF 방지
- **요구사항**: SameSite 쿠키 설정

#### SEC-007: 민감 정보 보호
- **요구사항**:
  - 비밀번호는 로그에 기록하지 않음
  - 토큰은 로그에 기록하지 않음
  - 환경 변수로 민감 정보 관리

### 9.3 네트워크 보안

#### SEC-008: HTTPS 사용
- **요구사항**: 프로덕션 환경에서는 HTTPS 필수

#### SEC-009: CORS 설정
- **요구사항**: 허용된 오리진만 접근 가능하도록 설정

---

## 10. 성능 요구사항

### 10.1 응답 시간

#### PERF-001: API 응답 시간
- **요구사항**: 
  - 일반 API: 1초 이내 (95 percentile)
  - 검색 API: 1초 이내
  - 요약 생성: 30초 이내 (비동기)

### 10.2 처리량

#### PERF-002: 동시 사용자
- **요구사항**: 최소 100명의 동시 사용자 지원

#### PERF-003: 요청 처리량
- **요구사항**: 초당 최소 50 TPS 처리

### 10.3 최적화

#### PERF-004: 데이터베이스 최적화
- **요구사항**:
  - 인덱싱: username, email, user_id
  - 연결 풀 사용
  - 쿼리 최적화 (EXISTS 서브쿼리)

#### PERF-005: 프론트엔드 최적화
- **요구사항**:
  - 컴포넌트 메모이제이션
  - 코드 스플리팅
  - 페이지네이션

---

## 11. 사용성 요구사항

### 11.1 사용자 인터페이스

#### UX-001: 직관적인 UI
- **요구사항**:
  - 명확한 네비게이션
  - 일관된 디자인
  - 명확한 버튼 및 링크

#### UX-002: 피드백 제공
- **요구사항**:
  - 로딩 상태 표시
  - 성공/실패 메시지 표시
  - 에러 메시지 명확하게 표시

#### UX-003: 반응형 디자인
- **요구사항**: 모든 화면 크기에서 정상 동작

### 11.2 사용자 경험

#### UX-004: 키보드 단축키
- **요구사항**: 기본 브라우저 단축키 지원 (선택사항)

#### UX-005: 접근성
- **요구사항**: 
  - 스크린 리더 호환성 (권장)
  - 키보드 네비게이션 지원 (권장)

---

## 12. 제약사항

### 12.1 기술적 제약사항

#### CON-001: 기술 스택
- **제약사항**: 
  - Backend: Python/FastAPI 고정
  - Frontend: React 고정
  - 데이터베이스: PostgreSQL 고정

#### CON-002: 외부 의존성
- **제약사항**: 
  - Ollama 서버 필요
  - PostgreSQL 데이터베이스 필요

### 12.2 비즈니스 제약사항

#### CON-003: 개발 기간
- **제약사항**: 기존 구현 완료 상태 유지

#### CON-004: 예산
- **제약사항**: 오픈소스 기술 스택 사용

---

## 13. 우선순위

### 13.1 기능 우선순위

#### Must Have (필수)
- 사용자 인증 및 권한 관리
- 북마크 생성, 조회, 수정, 삭제
- 웹 스크래핑
- AI 기반 요약 생성
- 키워드 자동 추출
- 다중 키워드 필터 검색
- 부분 일치 검색
- 로그 관리

#### Should Have (권장)
- 키워드 구분자 지원 (OR 조건)
- 필터 시각화
- 로그 통계
- 성능 최적화

#### Nice to Have (선택)
- 북마크 공유 기능
- 북마크 내보내기/가져오기
- 북마크 즐겨찾기
- 전체 텍스트 검색

---

## 14. 테스트 요구사항

### 14.1 단위 테스트

#### TEST-001: 백엔드 단위 테스트
- **요구사항**: 
  - CRUD 함수 단위 테스트
  - 비즈니스 로직 단위 테스트
  - 커버리지: 최소 70%

#### TEST-002: 프론트엔드 단위 테스트
- **요구사항**: 
  - 컴포넌트 단위 테스트
  - 유틸리티 함수 단위 테스트
  - 커버리지: 최소 60%

### 14.2 통합 테스트

#### TEST-003: API 통합 테스트
- **요구사항**: 
  - API 엔드포인트 통합 테스트
  - 인증 플로우 테스트
  - 에러 처리 테스트

### 14.3 시스템 테스트

#### TEST-004: 시스템 테스트
- **요구사항**: 
  - 전체 시스템 플로우 테스트
  - 성능 테스트
  - 보안 테스트

---

## 15. 배포 요구사항

### 15.1 배포 환경

#### DEPLOY-001: 개발 환경
- **요구사항**: 
  - 로컬 개발 환경 지원
  - Hot reload 지원
  - 디버깅 도구 지원

#### DEPLOY-002: 프로덕션 환경
- **요구사항**: 
  - Nginx 리버스 프록시 사용
  - SSL/TLS 인증서 설정
  - 환경 변수로 설정 관리 (`.env` 파일 기반)
  - 모든 설정값은 `.env` 파일에서 관리하며 코드에는 하드코딩된 값 없음

#### DEPLOY-004: Backend Docker 배포
- **요구사항**:
  - Backend는 Docker Compose로 **독립** 배포 가능 (맥/리눅스)
  - 실행 시 환경 변수는 **`.env`** 파일 사용 (빌드 시에는 .env 미포함)
  - 외부 PostgreSQL 사용 기본 (`.env`의 `DB_HOST` 등). 내부 Postgres는 `--profile internal-db` 로 선택 기동
  - 별도 Nginx 사용 시 Compose 내부 Nginx는 기동하지 않음 (`--profile with-nginx` 로 선택 기동)
  - 상세 절차: [Backend DOCKER_DEPLOY.md](./backend/DOCKER_DEPLOY.md) 참고

#### DEPLOY-005: Frontend Docker 배포
- **요구사항**:
  - Frontend는 Backend와 별도로 Docker Compose로 **독립** 배포 (frontend 디렉터리 기준)
  - 실행: `cd frontend && docker compose up -d` → 포트 3000에서 서빙
  - 빌드 시 `REACT_APP_API_URL=/api` 주입. 배포 시 Nginx 등에서 `/api`를 백엔드로 프록시
  - 상세 절차: [Frontend DOCKER_DEPLOY.md](./frontend/DOCKER_DEPLOY.md) 참고

### 15.2 배포 프로세스

#### DEPLOY-003: 배포 자동화
- **요구사항**: 
  - 배포 스크립트 제공
  - 데이터베이스 마이그레이션 지원
  - 롤백 프로세스 정의

---

## 16. 운영 요구사항

### 16.1 모니터링

#### OPS-001: 로그 모니터링
- **요구사항**: 
  - 파일 로깅 (backend/logs/app.log)
  - 데이터베이스 로깅
  - 로그 레벨: DEBUG, INFO, WARN, ERROR

#### OPS-002: 성능 모니터링
- **요구사항**: 
  - API 응답 시간 모니터링
  - 데이터베이스 쿼리 성능 모니터링
  - 에러율 모니터링

### 16.2 유지보수

#### OPS-003: 백업
- **요구사항**: 
  - 데이터베이스 정기 백업
  - 백업 복구 프로세스 정의

#### OPS-004: 업데이트
- **요구사항**: 
  - 무중단 업데이트 지원 (가능한 경우)
  - 다운타임 최소화

---

## 17. 참고 문서

- [설계서](./linkdigest_설계서.md): 본 PRD 요구사항의 상세 설계·아키텍처·API·보안·배포 등이 반영됨
- [설계서 vs PRD 검토](./linkdigest_설계서_PRD검토.md): 요구사항 대비 설계서 충족도 검토
- [Backend 문서](./backend/backend.md)
- [Frontend 문서](./frontend/frontend.md)
- [FastAPI 공식 문서](https://fastapi.tiangolo.com/)
- [React 공식 문서](https://react.dev/)
- [Ollama 공식 문서](https://ollama.ai/docs)

## 18. 요구사항-설계 추적

본 PRD의 요구사항 ID(FR-xxx, NFR-xxx, US-xxx 등)는 설계서(linkdigest_설계서.md)에서 다음과 같이 반영된다.

| PRD 구분 | 설계서 반영 위치 |
|----------|------------------|
| 기능 요구사항(FR), API | §6 API 설계, §11 주요 기능 상세 |
| 비기능(NFR), 성능 | §8 성능 최적화, §7 보안 설계 |
| 데이터(DR) | §5 데이터베이스 설계 |
| 보안(SEC) | §7 보안 설계 |
| 시스템(SR), 인터페이스(IR) | §10.1 환경 요구사항, §4.2 UI 요구사항 |
| 테스트(TEST) | §10.6 테스트 전략 |
| 배포(DEPLOY), 운영(OPS) | §10 배포 및 운영 |
| 제약사항(CON) | §1.3 제약사항 |

상세 설계·구현 방식은 설계서를 참조한다.

---

## 최근 업데이트

### 2026-02-14: 환경 변수 관리 개선 및 UI 개선

#### 환경 변수 관리 개선
- **완전한 .env 파일 기반 설정**: 모든 설정값을 `.env` 파일에서 관리
- **하드코딩 제거**: Backend와 Frontend 코드에서 하드코딩된 값 제거
- **Pydantic Settings 활용**: Backend에서 환경 변수 자동 로드 및 검증
- **설정 우선순위 명확화**: 시스템 환경 변수 → `.env` 파일 → 기본값

#### UI 개선
- **코드 블록 스타일 개선**: 다크 테마 적용으로 가독성 향상
- **모바일 최적화**: 터치 스크롤 지원 및 반응형 스타일

### 2026-02-14: Docker 배포 문서화
- **Backend**: Docker Compose 배포 패키지 추가 (Dockerfile, docker-compose.yml, DOCKER_DEPLOY.md). 외부 DB 사용 기본, nginx/postgres는 profile로 선택 기동. DB 연결 검증 스크립트(scripts/verify_db.py) 및 실행 시 `.env` 사용 명시.
- **Frontend**: Docker 백엔드 연결 검증(verify-backend), start:docker, proxy 설정 및 도메인 접속 시 Invalid Host header 방지(DANGEROUSLY_DISABLE_HOST_CHECK) 반영.

### 2026-02-14: Frontend Docker 독립 구성
- **Frontend**: frontend 폴더에 Docker 독립 구성 (Dockerfile, docker-compose.yml, DOCKER_DEPLOY.md). Backend Compose와 분리, `cd frontend && docker compose up -d` 로 단독 실행. DEPLOY-005 요구사항 반영.

### 2026-02-14: 요구사항 보강 (v1.2)
- **문서 정보**: 참고 문서에 설계서(linkdigest_설계서.md), 설계서 vs PRD 검토 문서 링크 추가. 버전 1.2.
- **API**: IR-004 API 공통 에러 응답 요구사항 추가 (400/401/403/409/500). IR-003에 API 베이스 경로(/api, 향후 /api/v1) 명시. IR-005→IR-006 번호 조정.
- **기능**: FR-014 조회수 중복 증가 방지 정책(세션/사용자 기준) 명시. FR-022 로그 보관 30일·만료 세션 정리 보강.
- **비기능**: NFR-005에 HTTP 상태 코드·IR-004 참조. NFR-007 민감 정보 로그 미기록 문구 구체화. NFR-011 반응형 브레이크포인트(320/768/1024) 명시.
- **추적성**: §18 요구사항-설계 추적 섹션 추가 (PRD 요구사항 ID ↔ 설계서 섹션 매핑). §17 참고 문서에 설계서·검토 문서 설명 보강.

---

**문서 버전**: 1.2  
**최종 업데이트**: 2026-02-14  
**작성자**: LinkDigest 개발팀
