# 북마크 공유 기능 – 작업 절차 제안

북마크 보기 화면에서 **요약 내용**을 **Slack·Notion API**로 전달하는 공유 기능 추가를 위한 작업 순서입니다.

---

## 1. 요구사항 정리

- **공유 대상**: 북마크 상세 화면의 **요약 내용** (제목, URL, 요약 텍스트 등).
- **전송 경로**: Slack API, Notion API.
- **UI**: `<`(뒤로가기) 버튼 **우측**, **같은 라인**에 공유 아이콘 버튼 배치. 아이콘 크기는 뒤로가기와 동일, **색상만 다르게** (예: 회색/초록).

---

## 2. 작업 절차 제안

### 2.1 백엔드

| 단계 | 작업 | 설명 |
|------|------|------|
| 1 | **공유 전용 API 엔드포인트** | `POST /api/share` 또는 `POST /api/bookmarks/{id}/share` 등. 요청 본문에 `target: "slack" | "notion"`, 필요 시 채널/페이지 ID 등. |
| 2 | **Slack 연동** | Slack Webhook URL 또는 Web API 사용. 환경 변수로 `SLACK_WEBHOOK_URL` 또는 `SLACK_BOT_TOKEN` 관리. 전달 payload: 제목, URL, 요약 텍스트. |
| 3 | **Notion 연동** | Notion Integration Token + 데이터베이스/페이지 ID. 환경 변수로 `NOTION_TOKEN`, `NOTION_DATABASE_ID`(또는 페이지 ID) 관리. 요약을 블록 또는 페이지로 생성. |
| 4 | **인증·권한** | 공유 API는 로그인 사용자만 호출 가능. 북마크 소유자이거나 읽기 권한이 있는지 확인 후 전송. |
| 5 | **에러·응답** | Slack/Notion API 실패 시 4xx/5xx 및 메시지 반환. 프론트에서 토스트/메시지로 표시. |

**참고**: Slack/Notion API 키·Webhook URL은 **서버에만** 두고, 클라이언트는 자신의 백엔드 `/api/.../share` 만 호출하도록 합니다.

---

### 2.2 프론트엔드

| 단계 | 작업 | 설명 |
|------|------|------|
| 1 | **공유 버튼 UI** | `BookmarkDetail.js` 상단 섹션에서 `<` 버튼 **바로 오른쪽**에 공유 아이콘 버튼 추가. 같은 라인(`flex` 유지), 같은 크기(`w-6 h-6 sm:w-7 sm:h-7`), 색상만 구분(예: `text-gray-500` / `hover:text-gray-700` 또는 연두/보라). |
| 2 | **공유 모달/드롭다운** | 클릭 시 "Slack으로 공유" / "Notion으로 공유" 선택 UI. (선택 사항: 채널 선택, Notion 페이지 선택 등은 2단계에서 확장.) |
| 3 | **API 연동** | `api.share.toSlack(bookmarkId, payload)` / `api.share.toNotion(bookmarkId, payload)` 등으로 백엔드 공유 API 호출. 현재 북마크(`currentBookmark`)의 제목·URL·요약을 전달. |
| 4 | **로딩·결과 표시** | 전송 중 로딩, 성공 시 "Slack으로 공유되었습니다" / "Notion으로 공유되었습니다", 실패 시 에러 메시지 표시. |

---

### 2.3 설정·보안

| 단계 | 작업 | 설명 |
|------|------|------|
| 1 | **환경 변수** | 백엔드 `.env`에 `SLACK_WEBHOOK_URL`, `NOTION_TOKEN`, `NOTION_DATABASE_ID` 등 추가. `.gitignore`에 포함 여부 확인. |
| 2 | **설정 문서** | `docs/` 또는 `backend/`에 Slack/Notion 연동 방법(Webhook 생성, Notion 연동 토큰 발급) 간단 정리. |

---

## 3. 권장 작업 순서 (한 번에 구현 시)

1. **백엔드**: Slack Webhook 또는 Notion 중 **하나만** 먼저 구현 (예: Slack).
2. **백엔드**: 공유 API 라우트 추가 및 인증·북마크 조회·Slack 전송까지 연동.
3. **프론트**: `BookmarkDetail`에 공유 버튼 추가(같은 라인, 같은 크기, 다른 색).
4. **프론트**: 공유 클릭 시 모달/드롭다운 → "Slack으로 공유" 선택 시 API 호출 → 성공/실패 메시지.
5. **백엔드**: Notion API 연동 추가.
6. **프론트**: "Notion으로 공유" 옵션 추가 및 API 연동.
7. **문서·환경 변수**: 설정 방법과 환경 변수 정리.

---

## 4. UI 배치 (요약)

- **위치**: `BookmarkDetail` 상단 첫 번째 줄.  
  `[ < 뒤로가기 ]` **바로 오른쪽**에 `[ 공유 아이콘 ]` 배치.  
  같은 줄 오른쪽은 기존처럼 페이지네이션 유지.
- **레이아웃 예**:  
  `[<] [공유] ··· (빈 공간) ··· [이전] [1] [2] [다음]`

---

## 5. 다음 단계

- 위 순서대로 **Slack 먼저** 구현 후, **Notion** 추가하는 것을 권장합니다.
- 구현 단계별로 필요한 경우: API 스펙(요청/응답), `BookmarkDetail` 수정 위치, 모달 컴포넌트 구조 등을 더 구체화할 수 있습니다.

원하시면 2.1의 백엔드 API 스펙(경로, body, 환경 변수)부터 구체적으로 적어 드리겠습니다.
