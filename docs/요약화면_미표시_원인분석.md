# 요약 화면 미표시 원인 분석

## 현상
- URL 중복 체크 기능 추가 후, 컨텐츠 요약이 동작하지 않고 요약 화면이 보이지 않음.

---

## 연관성 분석 (URL 중복 수정과의 관계)

### URL 중복 기능에서 수정한 부분
| 위치 | 변경 내용 |
|------|-----------|
| `backend/app/crud/crud_bookmark.py` | `get_by_url()` 추가, 생성 API에서 호출 |
| `backend/app/api/endpoints/bookmarks.py` | 북마크 생성 시 `get_by_url`로 중복 검사 |
| `frontend/AddBookmark.js` | 409 시 `onDuplicateError` 콜백 호출 후 `onClose()` |
| `frontend/BookmarkList.js` | 중복 오류 모달 상태 및 오류 UI 렌더 |

- **요약 관련 코드**: 백엔드 북마크 생성 후 `submit_summary_task()` 호출, 요약 조회 API, BookmarkDetail 요약 폴링 로직은 **전혀 수정하지 않음**.

**결론: 요약 화면 미표시는 URL 중복 체크 변경과 직접적인 인과관계가 없습니다.**

---

## 실제 원인

### `frontend/src/utils/api.js` – `getBookmark` 미구현

- **BookmarkDetail**은 요약이 “요약 생성 중...”일 때 **2초마다** `api.bookmarks.getBookmark(bookmarkId)`를 호출해 최신 요약을 가져옵니다.
- `getBookmark`는 **스텁** 상태였습니다:
  ```javascript
  getBookmark: async (id) => {
      // ...
  },
  ```
  → **아무 값도 반환하지 않음(undefined)**.

- 동작 결과:
  1. 첫 폴링에서 `getBookmark(id)` 호출 → `undefined` 반환.
  2. `setCurrentBookmark(response)` → `setCurrentBookmark(undefined)`.
  3. BookmarkDetail 상단 조건문: `if (!bookmark || !currentBookmark) return null;`
  4. **상세(요약) 영역 전체가 unmount 되어 요약 화면이 사라짐.**

즉, **요약 API가 아니라 “요약 갱신용 API인 getBookmark가 비어 있어서** 한 번만 폴링해도 화면이 사라지는 구조였습니다.

---

## 수정 내용

- `api.bookmarks.getBookmark(id)`를 **실제 GET 요청**으로 구현했습니다.
  - `GET /bookmarks/{id}` 호출 후 `response.data` 반환 (기존 `getById`/`getDetail`와 동일한 동작).

이제 BookmarkDetail의 폴링이 올바른 북마크(요약 포함) 데이터를 받고, 요약이 생성되면 요약 화면이 정상 표시됩니다.

---

## 재발 방지

- `getBookmark`처럼 “나중에 구현”으로 남겨둔 스텁은 사용처(BookmarkDetail 폴링)와 함께 확인 후, **최소한 다른 조회 API(getById 등)와 동일한 구현**으로 채워 두는 것이 좋습니다.
- 요약/상세 플로우는 “추가 후 상세 열기 → 요약 로딩 → 요약 표시” 한 번 수동 확인해 두면 유리합니다.
