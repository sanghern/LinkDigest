# 네이버 뉴스(n.news.naver.com) 스크래핑 대응

## 대상 URL
- `https://n.news.naver.com/mnews/article/422/0000834400`  
- 예: [\'공문 HTML\' 파일 열었더니…진화한 기업메일 해킹](https://n.news.naver.com/mnews/article/422/0000834400)

## 분석 결과 요약

| 항목 | 내용 |
|------|------|
| **HTTP 응답** | 200 OK, HTML 약 242KB 정상 수신 |
| **본문 위치** | `#newsct_article` → 내부 `#dic_area` (class `_article_content`) |
| **본문 구조** | **`<p>` 미사용**, 본문이 **텍스트 + `<br>`** 로만 구성됨 |
| **원인** | ① 메인 컨텐츠 선택자에 네이버 뉴스 전용 선택자 없음. ② 본문 추출이 `<p>`/`<div>` 등 태그 기준이라, `<br>`로만 나뉜 텍스트는 추출되지 않음. |

## 상세 분석

### 1. HTML 구조
- **제목**: `og:title`, `<title>` 에 정상 존재.
- **본문 영역**:
  - `#contents` → `#newsct_article.newsct_article._article_body` → 그 안에 **`<article id="dic_area" class="go_trans _article_content">`** 가 실제 기사 본문.
- **본문 내용**:
  - 이미지 캡션(`.end_photo_org`) 다음에 **순수 텍스트 + `<br><br>`** 로 문단 구분. `<p>` 태그 없음.
  - 예: `최근 네이버웍스 사용자를...<br><br>오늘(15일) 정보통신기술...`

### 2. 기존 스크래퍼 한계
- 메인 컨텐츠를 `article`, `main`, `.post-content` 등으로만 찾아 **네이버 전용 영역(`#newsct_article`, `#dic_area`)을 우선 사용하지 않음**.
- 문단 추출이 **`find_all(['h1','h2',...,'p','div'])`** 에만 의존해, **태그로 감싸지지 않은 텍스트 + `<br>`** 구간은 수집되지 않음.

## 조치 사항 (구현 반영)

1. **메인 컨텐츠 선택자 추가** (우선 적용)
   - `#newsct_article` (네이버 뉴스 기사 래퍼)
   - `#dic_area` (기사 본문)
   - `._article_content` (본문 클래스)

2. **`<br>` 본문 보완 로직**
   - `p`/`div` 등으로 수집한 문단이 **매우 적을 때**(예: 3개 미만) **그리고** target 전체 텍스트가 일정 길이(200자 초과)일 때,
   - target 내 **`<br>`을 줄바꿈(`\n`)으로 치환**한 뒤, **줄 단위로 split**하여 20자 이상인 문장만 content에 추가.

## 참고
- 수정 파일: `backend/app/services/scraping_service.py`
  - 메인 컨텐츠 선택자: `#newsct_article`, `#dic_area`, `._article_content` 추가.
  - 본문 추출: 3.5단계로 “텍스트+<br>만 있는 본문” 보완 로직 추가.
